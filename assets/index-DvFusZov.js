(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function d(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(t){if(t.ep)return;t.ep=!0;const e=d(t);fetch(t.href,e)}})();document.addEventListener("DOMContentLoaded",()=>{const p=document.getElementById("search-input"),c=document.getElementById("search-btn"),d=document.getElementById("top-btn"),a=document.getElementById("back-btn"),t=document.getElementById("loading"),e=document.getElementById("anime-grid"),s=document.getElementById("anime-detail");u(),c.addEventListener("click",()=>{const n=p.value.trim();n&&h(n)}),d.addEventListener("click",u),a.addEventListener("click",f);async function u(){l(),e.innerHTML="";try{const i=await(await fetch("https://api.jikan.moe/v4/top/anime?limit=12")).json();g(i.data)}catch(n){console.error("Error fetching top anime:",n),e.innerHTML="<p>Ошибка загрузки данных. Пожалуйста, попробуйте позже.</p>"}finally{m()}}async function h(n){l(),e.innerHTML="";try{const o=await(await fetch(`https://api.jikan.moe/v4/anime?q=${n}&limit=12`)).json();g(o.data)}catch(i){console.error("Error searching anime:",i),e.innerHTML="<p>Ошибка поиска. Пожалуйста, попробуйте позже.</p>"}finally{m()}}function g(n){if(e.innerHTML="",!n||n.length===0){e.innerHTML="<p>Аниме не найдено.</p>";return}n.forEach(i=>{const o=document.createElement("div");o.className="anime-card",o.innerHTML=`
        <img src="${i.images.jpg.image_url}" alt="${i.title}">
        <h3>${i.title}</h3>
      `,o.addEventListener("click",()=>L(i.mal_id)),e.appendChild(o)}),f()}async function L(n){l();try{const r=(await(await fetch(`https://api.jikan.moe/v4/anime/${n}`)).json()).data;s.innerHTML=`
        <h2>${r.title}</h2>
        <img src="${r.images.jpg.large_image_url}" alt="${r.title}">
        <p><strong>Тип:</strong> ${r.type}</p>
        <p><strong>Эпизоды:</strong> ${r.episodes||"Неизвестно"}</p>
        <p><strong>Статус:</strong> ${r.status}</p>
        <p><strong>Рейтинг:</strong> ${r.score||"Нет оценки"}</p>
        <p><strong>Жанры:</strong> ${r.genres.map(E=>E.name).join(", ")}</p>
        <p><strong>Описание:</strong> ${r.synopsis||"Нет описания"}</p>
      `,y(),s.classList.remove("hidden"),a.classList.remove("hidden")}catch(i){console.error("Error fetching anime details:",i),s.innerHTML="<p>Ошибка загрузки деталей. Пожалуйста, попробуйте позже.</p>"}finally{m()}}function l(){t.classList.remove("hidden")}function m(){t.classList.add("hidden")}function f(){e.classList.remove("hidden"),s.classList.add("hidden"),a.classList.add("hidden")}function y(){e.classList.add("hidden")}});
